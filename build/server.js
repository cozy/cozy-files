// Generated by CoffeeScript 1.9.0
var americano, application, errorHandler, initialize;

americano = require('americano');

errorHandler = require('./server/middlewares/errors');

initialize = require('./server/initialize');

application = module.exports = function(callback) {
  var options;
  options = {
    name: 'cozy-files',
    root: __dirname,
    port: process.env.PORT || 9121,
    host: process.env.HOST || '127.0.0.1'
  };
  return initialize.beforeStart(function() {
    return americano.start(options, function(app, server) {
      app.server = server;
      app.use(errorHandler);
      return initialize.afterStart(app, server, callback);
    });
  });
};

if (!module.parent) {
  application();
}
