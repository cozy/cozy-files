// Generated by CoffeeScript 1.9.0
var File, Folder, async;

File = require('../models/file');

Folder = require('../models/folder');

async = require('async');

module.exports.updateIndex = function(callback) {
  return File.all(function(err, files) {
    if (err) {
      return console.log(err);
    } else {
      return async.eachSeries(files, function(file) {
        return file.index(['name'], function() {});
      }, function() {
        return Folder.all(function(err, folders) {
          if (err) {
            return console.log(err);
          } else {
            return async.eachSeries(folders, function(folder) {
              return folder.index(['name'], function() {});
            }, function() {
              console.log('Re-indexation is done.');
              if (callback) {
                return callback();
              }
            });
          }
        });
      });
    }
  });
};
